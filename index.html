<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Glass-Rails by logical42</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Glass-Rails</h1>
        <h2>A DSL for building google glass apps using ruby on rails. </h2>
        <a href="https://github.com/logical42/glass-rails" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>Glass-Rails</h2>

<p>This is a ruby gem extracted out of <a href="http://thirst.co/glass">Thirst Droplet</a>, a google glass application. The goal of this gem is to provide a more convenient wrapper around the official <a href="https://github.com/google/google-api-ruby-client">Google Api Client for Ruby</a>. This gem is still quite young, and in development, so keep posted for updates (and we also &lt;3 pull requests). </p>

<h2>Installation</h2>

<p>Add the following to your Gemfile and then run <code>bundle install</code>.</p>

<div class="highlight"><pre><span class="n">gem</span> <span class="s1">'glass-rails'</span>
</pre></div>

<p>Or you can install the gem locally, by running the following command in the terminal:</p>

<pre lang="shell"><code>$ gem install glass-rails
</code></pre>

<h2>Basic Setup</h2>

<p>In order to get this gem setup for use, we require that you have some sort of user model already in place. You can, for example, have a <code>devise</code> generated User model, or a custom hand-rolled user model. </p>

<p>For convenience, this gem provides a command to scaffold some necessary files for glass development:</p>

<pre lang="shell"><code>$ rails g glass:install &lt;optional_name_of_user_model_which_otherwise_defaults_to_User&gt;
</code></pre>

<p>If the name of user model is not <code>User</code> then you must specify this when invoking the <code>glass:install</code> command:</p>

<pre lang="shell"><code>$ rails g glass:install person
</code></pre>

<h3>Files created by the <code>glass:install</code> generator</h3>

<ol>
<li>A <code>config/google-api-keys.yml</code> file for your client_id and client_secret api keys for accessing the mirror api.</li>
<li>A Glass::Rails initializer file in <code>config/initializers/glass.rb</code> for setting up default view paths for your glass templates.</li>
<li>Generates a <code>app/models/google_account.rb</code> model which is automatically associated to your user model.</li>
<li>A controller is created for 'listening' to subscription notifications from your glass users. </li>
</ol><h2>Pre-defined Templates for Glass</h2>

<p>This gem also includes pre-defined erb templates for use with timeline items. You can generate these templates for use by running the following command: </p>

<pre lang="shell"><code>$ rails g glass:templates
</code></pre>

<p>This will generate a name-spaced folder in your <code>app/views</code> directory called <code>glass</code> and populate it with a few useful predefined templates. </p>

<h2>Creating Timeline Items</h2>

<p>This gem also includes a generator for creating an ActiveRecord backed timeline item or a "glass model". </p>

<h2>Glass::TimelineItem (a superclass which you'll be inheriting from)</h2>

<p>The Glass::TimelineItem class is a subclass of ActiveRecord which is, for all intents and purposes, an abstract class. We've basically added a few convenience methods to ActiveRecord which allows for the easy population of custom menu items and some procedures for serializing these items for posting them to the glass timeline. </p>

<h3>The TimelineItem Generator</h3>

<p>You can generate a timeline_item model by executing the following command:</p>

<pre lang="shell"><code>$ rails g glass:model &lt;name of model&gt;
</code></pre>

<p>So, for the sake of illustration, let's say you wanted to generate a tweet model, which you intend to use to post particular tweets to a glass user's timeline. I would, then, execute this command:</p>

<pre lang="shell"><code>$ rails g glass:model tweet
</code></pre>

<p>This would create a model for me in the following directory <code>app/models/glass/tweet.rb</code>. This <code>Glass::Tweet</code> model would inherit from <code>Glass::TimelineItem</code> and would therefore be accompanied by a sugary goodness which makes posting to glass timelines a ton easier. </p>

<h4>Setting up a Glass Model</h4>

<h5>Defining a Default Template</h5>

<p>You may want to specify a default template to use for a given timeline item. For example, if I had two timeline item models, <code>Glass::Tweet</code> and another <code>Glass::BasketballScore</code>, then I could specify a default template for the tweet model to use by using a helper_method in the class definition, like so:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Glass</span><span class="o">::</span><span class="no">Tweet</span> <span class="o">&lt;</span> <span class="ss">Glass</span><span class="p">:</span><span class="ss">:TimelineItem</span>
  <span class="n">defaults_template</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">"tweet.html.erb"</span> <span class="c1">## this path is relative to your </span>
                                           <span class="c1">## glass_templates_path, which you can</span>
                                           <span class="c1">## set in your `config/initializers/glass.rb` file</span>

<span class="k">end</span>
</pre></div>

<p>and then you could define another default template for your basketball score model like so:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Glass</span><span class="o">::</span><span class="no">BasketballScore</span> <span class="o">&lt;</span> <span class="ss">Glass</span><span class="p">:</span><span class="ss">:TimelineItem</span>
  <span class="n">defaults_template</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">"two_column.html.erb"</span> <span class="c1">## since this would make sense if</span>
                                                <span class="c1">## wanted to show a score in each column.</span>
<span class="k">end</span>
</pre></div>

<h5>Defining Menu Items on the Timeline Item</h5>

<p>This gem provides some meta-programming magic to ease the creation of both custom and built-in menu-items for glass, by providing an easy to use DSL for specifying custom and built-in menu-items that a timeline-item should have..</p>

<p>For example, let's say I want to have two default actions on my <code>Glass::Tweet</code> object: 1) email this tweet to me. 2) read the tweet to me aloud. </p>

<p>Inside my <code>Glass::Tweet</code> class definition, I would specify these actions like so:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Glass</span><span class="o">::</span><span class="no">Tweet</span> <span class="o">&lt;</span> <span class="ss">Glass</span><span class="p">:</span><span class="ss">:TimelineItem</span>
  <span class="n">has_menu_item</span> <span class="ss">:email</span><span class="p">,</span> <span class="n">icon_url</span><span class="p">:</span> <span class="s2">"http://www.example.com/example-email-icon.png"</span><span class="p">,</span>
                        <span class="n">display_name</span><span class="p">:</span> <span class="s2">"Email"</span><span class="p">,</span> <span class="c1"># this is what is shown as text for the menu item</span>
                        <span class="n">handles_with</span><span class="p">:</span> <span class="ss">:email_callback</span> <span class="c1"># we'll ignore this for now.</span>
  <span class="n">has_menu_item</span> <span class="ss">:read_aloud</span>
<span class="k">end</span>
</pre></div>

<p>This would basically define two actions for all items posted with this glass model, i.e. Email &amp; Read Aloud.</p>

<p>You can define a different set of menu items for each model, so that would probably be something to consider when architecting your glass app. </p>

<h3>Subscriptions / Notifications</h3>

<p>The subscription/notification aspect of the mirror api is probably one of the most opaque aspects of the api (at least, in my opinion), but we've tried to include some tools to help get this part set up for you as well. </p>

<p>Basically, you need to register a callback url for your glass subscriptions, and you will get notified when a glass user invokes a custom menu item. </p>

<p>For example, if a glass user activates the menu-item <code>email</code>, then our glass app would get pinged on our subscription notification callback url. From here, we've implemented a callback handler which allows you to easily manipulate any callback logic, in the comfort of your timeline item model. </p>

<p>Specifically, whenever you define a custom menu item using our helper method:</p>

<div class="highlight"><pre>  <span class="o">.</span><span class="n">.</span>
  <span class="n">has_menu_item</span> <span class="ss">:email</span> <span class="o">.</span><span class="n">.</span>
       <span class="o">.</span><span class="n">.</span>
       <span class="n">handles_with</span><span class="p">:</span> <span class="ss">:email_callback_method</span>

<span class="no">We</span><span class="err">'</span><span class="n">ve</span> <span class="n">ensured</span> <span class="n">that</span> <span class="n">the</span> <span class="nb">method</span> <span class="sb">`email_callback_method`</span> <span class="nb">gets</span> <span class="n">executed</span> <span class="n">whenever</span> <span class="n">your</span> <span class="n">subscription</span> <span class="n">notification</span> <span class="n">callback</span> <span class="n">url</span> <span class="n">is</span> <span class="n">pinged</span> <span class="n">with</span> <span class="n">the</span> <span class="n">corresponding</span> <span class="n">menu</span><span class="o">-</span><span class="n">item</span> <span class="n">event</span><span class="o">.</span> 

</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/logical42/glass-rails/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/logical42/glass-rails/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/logical42/glass-rails"></a> is maintained by <a href="https://github.com/logical42">logical42</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-41071469-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>